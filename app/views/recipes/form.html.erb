<div class="index-header">
	<h2><%= action_name.capitalize %> Recipe</h2>
</div>

<%= nested_form_for @recipe, html: {id: "recipe-form"} do |f| %>
	<%= f.hidden_field :image_token %>
	<div class="row">
		<div class="col-md-7">
			<div class="form-group">
				<%= f.hidden_field :user_id, value: current_user.id %>
				<%= f.label :name %>
				<%= f.text_field :name, class: "form-control" %>
			</div>

			<div class="form-group">
				<%= f.label :description %>

				<%= f.text_field :description, class: "form-control" %>
			</div>
			<div class="form-group">
				<%= f.label :instructions, "Instructions (Optional)" %>

				<%= f.text_area :instructions, class: "form-control instructions", rows: 5 %>
				<%= content_for :javascripts do %>
					$(document).ready(function(){
				    $('.instructions').each(function(i, elem) {
				      $(elem).wysihtml5({'font-styles': false, 'image': false});
				    });
				  })
				<% end %>
			</div>
			<h4>Ingredients</h4>
			<%= f.fields_for :measurements do |m| %>
				<div class="row form-group add-ingredient">
					<div class="col-xs-5">
						<%= text_field_tag :ingredient_name, nil, class: "form-control", placeholder: "Name" %>
						<%= m.hidden_field :ingredient_id %>
					</div>
					<div class="col-xs-3">
						<%= m.text_field :amount, class: "form-control", placeholder: "Amt." %>
					</div>
					<div class="col-xs-3">
						<%= m.text_field :unit, class: "form-control", placeholder: "Unit" %>
					</div>
					<div class="col-xs-1">
						<%= m.link_to_remove raw(fa_icon "times-circle"), class: "btn-primary-bg" %>
					</div>
				</div>
			<% end %>
			<%= f.link_to_add "Add Ingredient", :measurements, class: "btn btn-xs btn-primary" %>
			<br>
			<br>
			<%= link_to "Cancel", :back, class: "btn btn-default" %>
			<%= f.submit "Save", class: "btn btn-success" %>
			<% end %>
		</div>
		<div class="col-md-5 text-center">
			<span id="img">
				<% if @recipe.image? %>
					<%= image_tag @recipe.image.image.url(:large), class: "img-thumbnail", style: "width: 100%" %>
					<%= link_to "Crop Photo", edit_image_path(@image), class: "btn btn-primary btn-block", remote: true %>
				<% else %>
					<%= fa_icon "picture-o", style: "font-size: 150px; color: #dddddd" %>
				<% end %>
			</span>
			<br>
			<%= form_for @image, remote: true, html: {id: "img-form"} do |image| %>
				<%= image.file_field :image,  id: "img-file" %>
				<%= link_to "Upload Photo", "#", class: "btn btn-primary btn-block", id: "img-btn" %>
				<%= image.hidden_field :imageable_id, value: @recipe.id %>
				<%= image.hidden_field :imageable_type, value: @recipe.class.name %>
				<%= image.hidden_field :token, value: @recipe.image_token %>
			<% end %>
		</div>
	</div>

